"use strict";(()=>{var e={};e.id=318,e.ids=[318],e.modules={829:e=>{e.exports=require("jsonwebtoken")},1421:e=>{e.exports=require("node:child_process")},1455:e=>{e.exports=require("node:fs/promises")},1708:e=>{e.exports=require("node:process")},3024:e=>{e.exports=require("node:fs")},3873:e=>{e.exports=require("path")},4552:(e,r,t)=>{t.r(r),t.d(r,{config:()=>y,default:()=>k,routeModule:()=>q});var s={};t.r(s),t.d(s,{default:()=>h});var o=t(3480),a=t(8667),n=t(6435),u=t(2852),i=t(829),d=t.n(i);let l=new u.PrismaClient,c=process.env.JWT_SECRET||"your-secret-key",p=e=>{try{return d().verify(e,c),!0}catch{return!1}},f=["k\xfcf\xfcr","hakaret","aptal","salak","mal","fuck","shit","stupid","idiot","noob"];function m(e){return!(e.length<3||e.length>20||!/^[a-zA-Z0-9_]+$/.test(e)||function(e){let r=e.toLowerCase();return f.some(e=>r.includes(e))}(e))}async function h(e,r){if("DELETE"===e.method){if(!function(e){let r=e.headers["x-api-key"];return!!r&&p(r)}(e))return r.status(401).json({error:"Yetkisiz erişim"});try{let{username:t}=e.query;if(!t||"string"!=typeof t)return r.status(400).json({error:"Ge\xe7ersiz kullanıcı adı"});let s=await l.score.deleteMany({where:{username:t}});if(0===s.count)return r.status(404).json({error:"Kullanıcı bulunamadı"});return r.status(200).json({message:"Skor başarıyla silindi"})}catch(e){return console.error("Skor silme hatası:",e),r.status(500).json({error:"Skor silinemedi"})}}if("POST"===e.method)try{let{username:t,score:s}=e.body;if(!t||"string"!=typeof t||!s||"number"!=typeof s)return r.status(400).json({error:"Ge\xe7ersiz kullanıcı adı veya skor"});if(!m(t))return r.status(400).json({error:"Ge\xe7ersiz kullanıcı adı formatı"});return await l.score.upsert({where:{username:t},update:{score:{set:Math.max(s,(await l.score.findUnique({where:{username:t}}))?.score||0)}},create:{username:t,score:s}}),r.status(200).json({message:"Skor başarıyla kaydedildi"})}catch(e){if("P2002"===e.code)return r.status(409).json({error:"Bu kullanıcı adı zaten kullanımda"});return console.error("Skor kaydetme hatası:",e),r.status(500).json({error:"Skor kaydedilemedi"})}if("GET"===e.method)try{let e=await l.score.findMany({orderBy:{score:"desc"},take:100});return r.status(200).json(e)}catch(e){return console.error("Skor listeleme hatası:",e),r.status(500).json({error:"Skorlar alınamadı"})}if("HEAD"===e.method)try{let t=e.query.username;if(!t||!m(t))return r.status(400).end();let s=await l.score.findUnique({where:{username:t}});return r.status(s?409:200).end()}catch(e){return r.status(500).end()}return r.status(405).json({error:"Method not allowed"})}let k=(0,n.M)(s,"default"),y=(0,n.M)(s,"config"),q=new o.PagesAPIRouteModule({definition:{kind:a.A.PAGES_API,page:"/api/scores",pathname:"/api/scores",bundlePath:"",filename:""},userland:s})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6698:e=>{e.exports=require("node:async_hooks")},6760:e=>{e.exports=require("node:path")},7066:e=>{e.exports=require("node:tty")},7598:e=>{e.exports=require("node:crypto")},7975:e=>{e.exports=require("node:util")},8161:e=>{e.exports=require("node:os")},8474:e=>{e.exports=require("node:events")},9021:e=>{e.exports=require("fs")}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[439],()=>t(4552));module.exports=s})();