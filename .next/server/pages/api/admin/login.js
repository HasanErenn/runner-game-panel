"use strict";(()=>{var e={};e.id=650,e.ids=[650],e.modules={496:(e,n,t)=>{t.a(e,async(e,r)=>{try{let u;t.r(n),t.d(n,{default:()=>d});var o=t(6330),s=t(3139),a=t(829),i=t.n(a),l=e([s]);async function d(e,n){if(n.setHeader("Access-Control-Allow-Credentials","true"),n.setHeader("Access-Control-Allow-Origin","*"),n.setHeader("Access-Control-Allow-Methods","GET,OPTIONS,PATCH,DELETE,POST,PUT"),n.setHeader("Access-Control-Allow-Headers","X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version"),"OPTIONS"===e.method)return n.status(200).end();if("POST"!==e.method)return console.log("Method not allowed:",e.method),n.status(405).json({message:"Method not allowed"});try{console.log("Request body:",e.body);let{username:t,password:r}=e.body;if(!t||!r)return console.log("Missing credentials"),n.status(400).json({message:"Username and password are required"});console.log("Looking for admin with username:",t);let o=await u.admin.findUnique({where:{username:t}});if(!o)return console.log("Admin not found"),n.status(401).json({message:"Invalid credentials"});if(console.log("Verifying password"),!await s.default.compare(r,o.password))return console.log("Invalid password"),n.status(401).json({message:"Invalid credentials"});console.log("Generating token");let a=i().sign({id:o.id,username:o.username},process.env.JWT_SECRET||"your-secret-key",{expiresIn:"1d"});return n.status(200).json({token:a})}catch(e){return console.error("Login error:",e),n.status(500).json({message:"Internal server error",error:e instanceof Error?e.message:String(e)})}}s=(l.then?(await l)():l)[0],u=new o.PrismaClient,r()}catch(e){r(e)}})},829:e=>{e.exports=require("jsonwebtoken")},3139:e=>{e.exports=import("bcryptjs")},3480:(e,n,t)=>{e.exports=t(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6330:e=>{e.exports=require("@prisma/client")},6435:(e,n)=>{Object.defineProperty(n,"M",{enumerable:!0,get:function(){return function e(n,t){return t in n?n[t]:"then"in n&&"function"==typeof n.then?n.then(n=>e(n,t)):"function"==typeof n&&"default"===t?n:void 0}}})},8074:(e,n,t)=>{t.a(e,async(e,r)=>{try{t.r(n),t.d(n,{config:()=>u,default:()=>d,routeModule:()=>c});var o=t(3480),s=t(8667),a=t(6435),i=t(496),l=e([i]);i=(l.then?(await l)():l)[0];let d=(0,a.M)(i,"default"),u=(0,a.M)(i,"config"),c=new o.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/admin/login",pathname:"/api/admin/login",bundlePath:"",filename:""},userland:i});r()}catch(e){r(e)}})},8667:(e,n)=>{Object.defineProperty(n,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var n=require("../../../webpack-api-runtime.js");n.C(e);var t=n(n.s=8074);module.exports=t})();